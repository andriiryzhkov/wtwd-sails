# Приклад курсового проекту/роботи з дисципліни "Веб-технології та веб-дизайн"

В якості прикладу буде створено веб-додаток для замовлення комунальних послуг. Передбачається реалізація можливості розмістити замовлення від клієнта для виконання певного виду комунальної послуги (погалодження електрики, прочистака каналізації, тощо). Клієнт при замовленні вибирає тип послуги та описує суть проблеми, яку необхідно вирішити. В процесі обслуговування, клієнт та виконавець можуть обмінуватись повідомленнями для уточнення ситуації. Виконане замовлення відповідно помічається.

## 1 Створіть каркас проекту

Для реалізації серверної частини скористаємость додатком [Sails.js](http://sailsjs.org) на платформі Node.js. Для встановлення останньої стабільної версії виконайте в командному рядку:

```
npm -g install sails
```

Новий проект створюється командою

```
sails new wtwd-sails
```

## 2 Створіть модель бази даних

Для створення моделі скористайтесь програмою [MySQL Workbench](http://dev.mysql.com/downloads/workbench/).

## 3 Перевірте модель бази даних на відповідність нормальним формам

Корисна стаття щодо нормалізації на Хабрахабр [Нормализация отношений. Шесть нормальных форм](http://habrahabr.ru/post/254773/)

Також корисно:
* [Руководство по проектированию реляционных баз данных](http://habrahabr.ru/post/193136/)
* [Описание основных приемов нормализации базы данных](https://support.microsoft.com/ru-ru/kb/283878)

## 4 Експортуйте модель у SQL-скрипт

Засіб для експорту моделі в SQL-скрипт знаходиться в меню MySQL Workbench: File - Export - Forward Engineer SQL CREATE Script.

## 5 Створіть базу даних

Маючи SQL-скрипт ви можете створити базу даних. Також можливе пряме створення бази даних з моделі. Для цього в меню MySQL Workbench скористайтесь командою: Database - Forward Engineer.

## 6 Стартові налаштування та генерація моделей серверної частини

Стартові налаштування включають параметри підключення до бази даних та деякі параметри функціонування sails. Дивіться відповідний commit для деталей.

Базові API серверної частини, які включають моделі та контролери генеруються задопомогою команд:

```
sails generate api user
sails generate api order
sails generate api type
sails generate api message
```

## 7 Створення моделей даних

На попередньому кроці були згенеровані наступні файли моделей даних нашого веб-додатку:

```
api/models/Message.js
api/models/Order.js
api/models/Type.js
api/models/User.js
```

Одразу після генерації вони практично порожні. Наприклад, модель User виглядає так:

```
module.exports = {

  attributes: {

  }
};
```

Нам слід визначити модель даних в об'єкті attributes, яка точно повторює нашу базу даних. **Назва кожного атрибуту має точно відповідати кожному атрибуту таблиці бази даних!**

Документтація щодо створення атрибутів моделі наведена [тут](http://sailsjs.org/documentation/concepts/models-and-orm/attributes).

## 8 Створення механізму авторизації користувачів

В проекті реалізована проста авторизація користувачів. Для цого використовується пакет [Passport](http://passportjs.org/). Перш ніж продовжити треба встановити два нових пакети:

```
npm install --save passport passport-local
```

Наша модель користувача User вже містить необхідні дані:
- атрибут email, який використовуватиметься в якості імені користувача,
- атрибут password, відповідно, для зберігання пароля.

Зверніть увагу на доданий метод toJSON в моделі User. Цей метод перевизначає вбудований метод з метоє видалити пароль з вихідного потоку даних, тобто скрити пароль.

В контролері UserController додані методи пов'язані з процесом авторизації.
